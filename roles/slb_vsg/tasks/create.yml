---
- name: "[ {{ islb.load_balancers.0.id }} - {{ vsg.name }} ] Creating VSG"
  ali_slb_vsg:
    alicloud_access_key: '{{ access_key }}'
    alicloud_secret_key: '{{ secret_key }}'
    alicloud_region: '{{ region }}'
    load_balancer_id: '{{ islb.load_balancers.0.id }}'
    vserver_group_name: '{{ vsg.name }}'
    backend_servers: '{{ vsg.backend }}'
    state: present
  when:
    - ivsg.vserver_groups.0.id is not defined
  register: cvsg

- name: "[ {{ islb.load_balancers.0.id }} - {{ vsg.name }} ] Creating VSG - Configuring Listener"
  include_role:
    name: slb_vsg_listener
  when:
    - vsg.listener is defined
